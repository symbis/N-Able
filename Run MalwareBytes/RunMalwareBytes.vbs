' ################################################################################### 
' #   Copyright 2009 by KKI Technologies                                            # 
' #   All Rights Reserved                                                           # 
' #   www.kkitechnologies.com                       	 	                    # 
' #   Edited by Jake Richie for execution                                           #
' ################################################################################### 
 
 
' Script Name: RunMalwareBytes.vbs 
' Description: This VBS file will run the mbam.exe program with the following switches: 
' 	 	 /minimized - this minimizes the program to the taskbar 
' 	 	 /runupdate - runs autoupdate as soon as the program starts 
' 	 	 /quickscanterminate - starts a quick scan immediately and terminates the program after completion


' Version History

' 1.1 - Added support for x64 machines by making the script use the %ProgramFiles(x86)% variable, instead of hardcoding the path to C:\Program Files\ (Feb 16th, 2012)

' 1.0 - Initial Release (2009)






' Lets Determine if this is a 32-bit machine or a 64-bit machine (as this will determine what environment variable this script calls)
Set WshShell = CreateObject("WScript.Shell")
Set output = Wscript.stdout
Set objWMIService = GetObject("winmgmts:\\" & "." & "\root\CIMV2")
Set colItems = objWMIService.ExecQuery("SELECT AddressWidth FROM Win32_Processor where DeviceID='CPU0'", "WQL", _
wbemFlagReturnImmediately + wbemFlagForwardOnly)

For each objItem in colItems 
                AddressWidth = objItem.AddressWidth
Next


  If AddressWidth = 64 Then
    'This is a 64-bit machine
    ProgramFiles = WshShell.ExpandEnvironmentStrings("%PROGRAMFILES(x86)%")
    output.writeline "This is a 64-bit machine; Malware Bytes should be located in: " & ProgramFiles & "\Malwarebytes' Anti-Malware\"
  ElseIf AddressWidth = 32 Then
    'This is a 32-bit machine
    ProgramFiles = WshShell.ExpandEnvironmentStrings("%PROGRAMFILES%")
    output.writeline "This is a 32-bit machine; Malware Bytes should be located in: " & ProgramFiles & "\Malwarebytes' Anti-Malware\"
  Else
    'Windows doesn't know what OS Type it's running
    output.writeline "The type of OS is unknown - the script can't detect if it's 32-bit or 64-bit."
  End If
 
    
     
' Run the command
Set Shell = CreateObject ("Wscript.shell")
cmdline="" & chr(34) & ProgramFiles & "\Malwarebytes' Anti-Malware\mbam.exe" & chr(34) & "/minimized /runupdate /quickscanterminate"
Shell.Run cmdline,7,TRUE
Set Shell=Nothing
